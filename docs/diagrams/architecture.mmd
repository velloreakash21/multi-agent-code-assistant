%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#4A90D9', 'primaryTextColor': '#fff', 'primaryBorderColor': '#2E5A8A', 'lineColor': '#666', 'secondaryColor': '#F5A623', 'tertiaryColor': '#50C878'}}}%%
flowchart TB
    subgraph User["User Interface"]
        Q[("User Query")]
    end

    subgraph Orchestration["Orchestration Layer"]
        O["Orchestrator Agent<br/>(Query Analysis & Routing)"]
    end

    subgraph Agents["Specialized Agents"]
        DS["Doc Search Agent<br/>• Tavily API<br/>• Web Documentation"]
        CQ["Code Query Agent<br/>• SQLcl MCP Tools<br/>• Code Snippets"]
    end

    subgraph MCP["Model Context Protocol"]
        MCP_SRV["SQLcl MCP Server<br/>• Standardized Protocol<br/>• Security & Audit"]
    end

    subgraph Database["Data Layer"]
        TAVILY[("Tavily API<br/>Web Search")]
        ORACLE[("Oracle Database 23ai<br/>40+ Code Snippets")]
    end

    subgraph Observability["Observability"]
        OTEL["OpenTelemetry<br/>Distributed Tracing"]
        JAEGER["Jaeger UI<br/>Trace Visualization"]
    end

    Q --> O
    O --> DS
    O --> CQ
    DS --> TAVILY
    CQ --> MCP_SRV
    MCP_SRV --> ORACLE

    DS -.-> OTEL
    CQ -.-> OTEL
    MCP_SRV -.-> OTEL
    OTEL --> JAEGER

    O --> R[("Combined Response<br/>+ Trace Metadata")]

    style Q fill:#4A90D9,stroke:#2E5A8A,color:#fff
    style O fill:#F5A623,stroke:#C4841D,color:#fff
    style DS fill:#50C878,stroke:#3A9B5A,color:#fff
    style CQ fill:#50C878,stroke:#3A9B5A,color:#fff
    style MCP_SRV fill:#9B59B6,stroke:#7D3C98,color:#fff
    style TAVILY fill:#E74C3C,stroke:#C0392B,color:#fff
    style ORACLE fill:#E74C3C,stroke:#C0392B,color:#fff
    style OTEL fill:#3498DB,stroke:#2980B9,color:#fff
    style JAEGER fill:#3498DB,stroke:#2980B9,color:#fff
    style R fill:#4A90D9,stroke:#2E5A8A,color:#fff
